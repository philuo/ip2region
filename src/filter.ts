import { readFileSync, writeFileSync } from 'fs';
import { resolve } from 'path';

const regHead = '\\n(?:\\d{1,3}.){3}\\d{1,3}\\|(?:\\d{1,3}.){3}\\d{1,3}\\|';
const regTail = '(\\|.*){4}';
const countryFilterList = [
    '美国',
    '日本',
    '印度',
    '泰国',
    '英国',
    '法国',
    '德国',
    '澳大利亚',
    '意大利',
    '韩国',
    '芬兰',
    '加拿大',
    '菲律宾',
    '土耳其',
    '新加坡',
    '荷兰',
    '罗马尼亚',
    '丹麦',
    '瑞士',
    '伊朗',
    '西班牙',
    '比利时',
    '俄罗斯',
    '波兰',
    '乌克兰',
    '以色列',
    '葡萄牙',
    '阿联酋',
    '新西兰',
    '缅甸',
    '越南',
    '印尼',
    '孟加拉国',
    '马来西亚',
    '尼泊尔',
    '南非',
    '巴西',
    '爱尔兰',
    '希腊',
    '瑞典',
    '奥地利',
    '捷克',
    '约旦',
    '卢森堡',
    '阿根廷',
    '乌干达',
    '亚美尼亚',
    '坦桑尼亚',
    '保加利亚',
    '布隆迪',
    '智利',
    '摩尔多瓦',
    '卡塔尔',
    '伊拉克',
    '拉脱维亚',
    '立陶宛',
    '乌兹别克斯坦',
    '斯洛伐克',
    '哈萨克斯坦',
    '格鲁吉亚',
    '爱沙尼亚',
    '巴勒斯坦',
    '匈牙利',
    '沙特阿拉伯',
    '挪威',
    '安哥拉',
    '冰岛',
    '柬埔寨',
    '北马其顿',
    '阿曼',
    '波黑',
    '阿塞拜疆',
    '黎巴嫩',
    '秘鲁',
    '吉尔吉斯斯坦',
    '泽西岛',
    '直布罗陀',
    '马恩岛',
    '马耳他',
    '叙利亚',
    '瓜德罗普',
    '马提尼克',
    '也门',
    '多米尼加',
    '墨西哥',
    '不丹',
    '关岛',
    '尼日利亚',
    '委内瑞拉',
    '美属维尔京群岛',
    '波多黎各',
    '哥伦比亚',
    '厄瓜多尔',
    '哥斯达黎加',
    '斯里兰卡',
    '巴哈马',
    '塞尔维亚',
    '巴拉圭',
    '危地马拉',
    '新喀里多尼亚',
    '巴布亚新几内亚',
    '斐济',
    '蒙古',
    '瓦利斯和富图纳',
    '巴基斯坦',
    '列支敦士登',
    '阿尔巴尼亚',
    '巴拿马',
    '肯尼亚',
    '科威特',
    '安道尔',
    '东帝汶',
    '马里',
    '加蓬',
    '喀麦隆',
    '科特迪瓦',
    '博茨瓦纳',
    '刚果共和国',
    '冈比亚',
    '莱索托',
    '马拉维',
    '埃及',
    '苏丹',
    '赞比亚',
    '贝宁',
    '加纳',
    '毛里求斯',
    '莫桑比克',
    '几内亚',
    '多哥',
    '赤道几内亚',
    '纳米比亚',
    '塞舌尔',
    '津巴布韦',
    '南苏丹',
    '佛得角',
    '英属印度洋领地',
    '阿尔及利亚',
    '中非',
    '布基纳法索',
    '马达加斯加',
    '留尼汪',
    '乍得',
    '马尔代夫',
    '塞浦路斯',
    '洪都拉斯',
    '特立尼达和多巴哥',
    '斯洛文尼亚',
    '巴林',
    '白俄罗斯',
    '根西岛',
    '克罗地亚',
    '法罗群岛',
    '几内亚比绍',
    '圣多美和普林西比',
    '索马里',
    '黑山',
    '库拉索',
    '圣马力诺',
    '欧洲地区',
    '梵蒂冈',
    '摩纳哥',
    '尼加拉瓜',
    '萨尔瓦多',
    '圭亚那',
    '法属圭亚那',
    '乌拉圭',
    '玻利维亚',
    '朝鲜',
    '瓦努阿图',
    '图瓦卢',
    '汤加',
    '所罗门群岛',
    '萨摩亚',
    '帕劳',
    '瑙鲁',
    '密克罗尼西亚联邦',
    '基里巴斯',
    '马绍尔群岛',
    '刚果金',
    '刚果布',
    '吉布提',
    '厄立特里亚',
    '埃塞俄比亚',
    '利比里亚',
    '利比亚',
    '毛里塔尼亚',
    '摩洛哥',
    '尼日尔',
    '卢旺达',
    '塞内加尔',
    '塞拉利昂',
    '斯威士兰',
    '突尼斯',
    '土库曼斯坦',
    '安提瓜和巴布达',
    '巴巴多斯',
    '古巴',
    '多米尼克',
    '格林纳达',
    '海地',
    '牙买加',
    '圣基茨和尼维斯',
    '圣卢西亚',
    '圣文森特和格林纳丁斯',
    '阿鲁巴',
    '阿富汗',
    '文莱',
    '老挝',
    '塔吉克斯坦',
    '荷属圣马丁',
    '圣皮埃尔和密克隆',
    '蒙塞拉特岛',
    '奥兰',
    '荷兰加勒比区',
    '刚果民主共和国',
    '马约特',
    '科摩罗',
    '开曼群岛',
    '非洲地区',
    '北美地区',
    '法属圣马丁',
    '百慕大',
    '伯利兹',
    '格陵兰',
    '苏里南',
    '特克斯和凯科斯群岛',
    '英属维尔京群岛',
    '安圭拉',
    '圣巴泰勒米',
    '福克兰群岛',
    '南极洲'
];

let file = readFileSync(resolve('./ip.txt'), 'utf-8');

countryFilterList.forEach(country => {
    const reg = new RegExp(`${regHead}${country}${regTail}`, 'g');

    file = file.replace(reg, '');
});

writeFileSync(resolve('./ip.merge.cn.txt'), file);